# Navigation Guide - NanoSolve Hive

## ðŸ—ºï¸ Complete Navigation Flow

### User Journey Map

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ONBOARDING (4 Pages)                      â”‚
â”‚  â€¢ Swipe left/right to navigate                             â”‚
â”‚  â€¢ "Skip" button (top-right) â†’ Path Selection              â”‚
â”‚  â€¢ "Next" button â†’ Next page                                â”‚
â”‚  â€¢ "Get Started" (page 4) â†’ Path Selection                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              PATH SELECTION SCREEN                           â”‚
â”‚  â€¢ Back button: None (entry point after onboarding)         â”‚
â”‚  â€¢ Tap Human Body card â†’ Category Detail (Body)            â”‚
â”‚  â€¢ Tap Planet Earth card â†’ Category Detail (Earth)         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              CATEGORY DETAIL SCREEN                          â”‚
â”‚  â€¢ Back button (top-left) â†’ Path Selection                 â”‚
â”‚  â€¢ "Back to Path Selection" button â†’ Path Selection        â”‚
â”‚  â€¢ "Continue to App" button â†’ Main App (removes history)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    MAIN APP                                  â”‚
â”‚  â€¢ Back button: Shows exit dialog                           â”‚
â”‚  â€¢ Bottom nav: Switch between 3 tabs                        â”‚
â”‚    - Library Tab (left)                                     â”‚
â”‚    - Ideas Tab (center FAB)                                 â”‚
â”‚    - Results Tab (right)                                    â”‚
â”‚  â€¢ Language selector (top-right header)                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ðŸ“± Navigation Controls

### 1. Hardware Back Button (Android)
- **Onboarding**: Goes back one page (native PageView behavior)
- **Path Selection**: No action (entry point)
- **Category Detail**: Returns to Path Selection
- **Main App**: Shows exit confirmation dialog

### 2. On-Screen Back Buttons
All screens with back buttons show them in the **top-left corner**:

#### Category Detail Screen
```dart
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â† [Back] Category Name    ðŸŒ CSâ”‚ â† Header with back button
â”‚                                â”‚
â”‚  [Category content]            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### Main App (Optional)
```dart
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ NANOHIVE              ðŸŒ CS    â”‚ â† No back button (main screen)
â”‚                                â”‚
â”‚  [Tab content]                 â”‚
â”‚                                â”‚
â”‚ â”Œâ”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”       â”‚
â”‚ â”‚ ðŸ“š â”‚  â”‚  +  â”‚  â”‚ ðŸ“Š â”‚       â”‚ â† Bottom navigation
â”‚ â””â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”˜       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3. Navigation Buttons

#### Onboarding Screen
- **Skip Button** (top-right): Available on pages 1-3
  - Action: Skip to Path Selection
  - Style: Text button, muted color

- **Next Button** (bottom): Available on all pages
  - Pages 1-3: "Next"
  - Page 4: "Get Started"
  - Style: Full-width primary button

#### Path Selection Screen
- **Path Cards**: Two large interactive cards
  - Action: Navigate to Category Detail
  - Visual: Gradient backgrounds with glow

#### Category Detail Screen
- **Back Icon** (top-left): iOS-style back arrow
  - Action: Return to Path Selection
  - Style: White arrow icon

- **Back to Path Selection** (bottom): Text link
  - Action: Same as back icon
  - Style: Text button with path color

- **Continue to App** (bottom): Primary CTA
  - Action: Navigate to Main App (clears navigation stack)
  - Style: Full-width button with path gradient color

#### Main App
- **Bottom Navigation**: 3 tabs
  - Tap any tab to switch views
  - Center tab has elevated FAB

- **Language Selector** (top-right): Dropdown
  - Shows current language with flag
  - Change language instantly

## ðŸ”„ Navigation Stack Management

### Clear Navigation (No Back History)
When these actions occur, the navigation stack is cleared:

1. **"Continue to App"** from Category Detail
   ```dart
   Navigator.pushAndRemoveUntil(
     MaterialPageRoute(builder: (_) => MainScreen()),
     (route) => false,  // Removes all previous routes
   );
   ```

### Preserve Navigation (Can Go Back)
Normal navigation that preserves history:

1. **Path Selection â†’ Category Detail**
   ```dart
   Navigator.push(
     MaterialPageRoute(builder: (_) => CategoryDetailScreen()),
   );
   ```

2. **Category Detail â†’ Path Selection** (back button)
   ```dart
   Navigator.pop(context);
   ```

## âš ï¸ Exit Confirmation

### Main App Exit Dialog
When pressing back button on Main App:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Exit App?                â”‚
â”‚                                  â”‚
â”‚  Are you sure you want to exit? â”‚
â”‚                                  â”‚
â”‚    [Cancel]        [Exit]        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

- **Cancel**: Stays in app
- **Exit**: Closes app (Android) or goes to previous screen

## ðŸŽ¯ Navigation Best Practices

### User Experience
âœ… Always show back button on secondary screens
âœ… Use exit dialog on main screen to prevent accidental exits
âœ… Clear navigation stack when entering main app
âœ… Provide multiple ways to go back (button + hardware back)
âœ… Maintain consistent navigation patterns

### Implementation
âœ… Use `PopScope` instead of deprecated `WillPopScope`
âœ… Check `context.mounted` before navigation after async operations
âœ… Use proper `pushAndRemoveUntil` to clear history
âœ… Handle both hardware and on-screen back buttons

## ðŸ”§ Customization

### Adding Back Button to Other Screens

1. Add parameters to screen widget:
```dart
class YourScreen extends StatelessWidget {
  final bool showBackButton;

  const YourScreen({this.showBackButton = true});
}
```

2. Pass to AppHeader:
```dart
AppHeader(
  selectedLanguage: localization.currentLanguage,
  onLanguageChanged: (lang) => setState(() {}),
  showBackButton: true,  // Enable back button
  onBackPressed: () => Navigator.pop(context),
)
```

### Customizing Navigation Behavior

Edit navigation logic in:
- [lib/screens/main_screen.dart](lib/screens/main_screen.dart) - Main app navigation
- [lib/screens/path_selection_screen.dart](lib/screens/path_selection_screen.dart) - Path navigation
- [lib/screens/category_detail_screen.dart](lib/screens/category_detail_screen.dart) - Category navigation

---

**Status**: âœ… All navigation controls implemented and tested
**Back Buttons**: Available on all secondary screens
**Exit Dialog**: Prevents accidental app closure
**Stack Management**: Proper history clearing on app entry
